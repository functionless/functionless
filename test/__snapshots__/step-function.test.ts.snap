// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`$SFN.forEach(list, (item) => task(item)) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "await $SFN.forEach(input.list, function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await $SFN.forEach(input.list, function(item))": Object {
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "Next": "return null",
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": null,
      "Type": "Map",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`$SFN.map(list, (item) => task(item)) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "await $SFN.map(input.list, function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await $SFN.map(input.list, function(item))": Object {
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "Next": "return null",
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": null,
      "Type": "Map",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`boolean logic 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_tmp = input.a && input.b": Object {
      "Choices": Array [
        Object {
          "And": Array [
            Object {
              "And": Array [
                Object {
                  "IsPresent": true,
                  "Variable": "$.a",
                },
                Object {
                  "IsNull": false,
                  "Variable": "$.a",
                },
                Object {
                  "Or": Array [
                    Object {
                      "And": Array [
                        Object {
                          "IsString": true,
                          "Variable": "$.a",
                        },
                        Object {
                          "Not": Object {
                            "And": Array [
                              Object {
                                "IsString": true,
                                "Variable": "$.a",
                              },
                              Object {
                                "StringEquals": "",
                                "Variable": "$.a",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    Object {
                      "And": Array [
                        Object {
                          "IsNumeric": true,
                          "Variable": "$.a",
                        },
                        Object {
                          "Not": Object {
                            "And": Array [
                              Object {
                                "IsNumeric": true,
                                "Variable": "$.a",
                              },
                              Object {
                                "NumericEquals": 0,
                                "Variable": "$.a",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    Object {
                      "And": Array [
                        Object {
                          "IsBoolean": true,
                          "Variable": "$.a",
                        },
                        Object {
                          "BooleanEquals": true,
                          "Variable": "$.a",
                        },
                      ],
                    },
                  ],
                },
              ],
            },
            Object {
              "And": Array [
                Object {
                  "IsPresent": true,
                  "Variable": "$.b",
                },
                Object {
                  "IsNull": false,
                  "Variable": "$.b",
                },
                Object {
                  "Or": Array [
                    Object {
                      "And": Array [
                        Object {
                          "IsString": true,
                          "Variable": "$.b",
                        },
                        Object {
                          "Not": Object {
                            "And": Array [
                              Object {
                                "IsString": true,
                                "Variable": "$.b",
                              },
                              Object {
                                "StringEquals": "",
                                "Variable": "$.b",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    Object {
                      "And": Array [
                        Object {
                          "IsNumeric": true,
                          "Variable": "$.b",
                        },
                        Object {
                          "Not": Object {
                            "And": Array [
                              Object {
                                "IsNumeric": true,
                                "Variable": "$.b",
                              },
                              Object {
                                "NumericEquals": 0,
                                "Variable": "$.b",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    Object {
                      "And": Array [
                        Object {
                          "IsBoolean": true,
                          "Variable": "$.b",
                        },
                        Object {
                          "BooleanEquals": true,
                          "Variable": "$.b",
                        },
                      ],
                    },
                  ],
                },
              ],
            },
          ],
          "Next": "assignTrue__0_tmp = input.a && input.b",
        },
      ],
      "Default": "assignFalse__0_tmp = input.a && input.b",
      "Type": "Choice",
    },
    "1_tmp = input.a || input.b": Object {
      "Choices": Array [
        Object {
          "Next": "assignTrue__1_tmp = input.a || input.b",
          "Or": Array [
            Object {
              "And": Array [
                Object {
                  "IsPresent": true,
                  "Variable": "$.a",
                },
                Object {
                  "IsNull": false,
                  "Variable": "$.a",
                },
                Object {
                  "Or": Array [
                    Object {
                      "And": Array [
                        Object {
                          "IsString": true,
                          "Variable": "$.a",
                        },
                        Object {
                          "Not": Object {
                            "And": Array [
                              Object {
                                "IsString": true,
                                "Variable": "$.a",
                              },
                              Object {
                                "StringEquals": "",
                                "Variable": "$.a",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    Object {
                      "And": Array [
                        Object {
                          "IsNumeric": true,
                          "Variable": "$.a",
                        },
                        Object {
                          "Not": Object {
                            "And": Array [
                              Object {
                                "IsNumeric": true,
                                "Variable": "$.a",
                              },
                              Object {
                                "NumericEquals": 0,
                                "Variable": "$.a",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    Object {
                      "And": Array [
                        Object {
                          "IsBoolean": true,
                          "Variable": "$.a",
                        },
                        Object {
                          "BooleanEquals": true,
                          "Variable": "$.a",
                        },
                      ],
                    },
                  ],
                },
              ],
            },
            Object {
              "And": Array [
                Object {
                  "IsPresent": true,
                  "Variable": "$.b",
                },
                Object {
                  "IsNull": false,
                  "Variable": "$.b",
                },
                Object {
                  "Or": Array [
                    Object {
                      "And": Array [
                        Object {
                          "IsString": true,
                          "Variable": "$.b",
                        },
                        Object {
                          "Not": Object {
                            "And": Array [
                              Object {
                                "IsString": true,
                                "Variable": "$.b",
                              },
                              Object {
                                "StringEquals": "",
                                "Variable": "$.b",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    Object {
                      "And": Array [
                        Object {
                          "IsNumeric": true,
                          "Variable": "$.b",
                        },
                        Object {
                          "Not": Object {
                            "And": Array [
                              Object {
                                "IsNumeric": true,
                                "Variable": "$.b",
                              },
                              Object {
                                "NumericEquals": 0,
                                "Variable": "$.b",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    Object {
                      "And": Array [
                        Object {
                          "IsBoolean": true,
                          "Variable": "$.b",
                        },
                        Object {
                          "BooleanEquals": true,
                          "Variable": "$.b",
                        },
                      ],
                    },
                  ],
                },
              ],
            },
          ],
        },
      ],
      "Default": "assignFalse__1_tmp = input.a || input.b",
      "Type": "Choice",
    },
    "__fnl_constants": Object {
      "Next": "0_tmp = input.a && input.b",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "assignFalse__0_tmp = input.a && input.b": Object {
      "Next": "1_tmp = input.a || input.b",
      "Result": false,
      "ResultPath": "$.0_tmp",
      "Type": "Pass",
    },
    "assignFalse__1_tmp = input.a || input.b": Object {
      "Next": "return {and: 0_tmp, or: 1_tmp}",
      "Result": false,
      "ResultPath": "$.1_tmp",
      "Type": "Pass",
    },
    "assignTrue__0_tmp = input.a && input.b": Object {
      "Next": "1_tmp = input.a || input.b",
      "Result": true,
      "ResultPath": "$.0_tmp",
      "Type": "Pass",
    },
    "assignTrue__1_tmp = input.a || input.b": Object {
      "Next": "return {and: 0_tmp, or: 1_tmp}",
      "Result": true,
      "ResultPath": "$.1_tmp",
      "Type": "Pass",
    },
    "return {and: 0_tmp, or: 1_tmp}": Object {
      "End": true,
      "Parameters": Object {
        "and.$": "$.0_tmp",
        "or.$": "$.1_tmp",
      },
      "ResultPath": "$",
      "Type": "Pass",
    },
  },
}
`;

exports[`boolean return 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.a && input.b",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "assignFalse__return input.a && input.b": Object {
      "End": true,
      "Result": false,
      "ResultPath": "$",
      "Type": "Pass",
    },
    "assignTrue__return input.a && input.b": Object {
      "End": true,
      "Result": true,
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return input.a && input.b": Object {
      "Choices": Array [
        Object {
          "And": Array [
            Object {
              "And": Array [
                Object {
                  "IsPresent": true,
                  "Variable": "$.a",
                },
                Object {
                  "IsNull": false,
                  "Variable": "$.a",
                },
                Object {
                  "Or": Array [
                    Object {
                      "And": Array [
                        Object {
                          "IsString": true,
                          "Variable": "$.a",
                        },
                        Object {
                          "Not": Object {
                            "And": Array [
                              Object {
                                "IsString": true,
                                "Variable": "$.a",
                              },
                              Object {
                                "StringEquals": "",
                                "Variable": "$.a",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    Object {
                      "And": Array [
                        Object {
                          "IsNumeric": true,
                          "Variable": "$.a",
                        },
                        Object {
                          "Not": Object {
                            "And": Array [
                              Object {
                                "IsNumeric": true,
                                "Variable": "$.a",
                              },
                              Object {
                                "NumericEquals": 0,
                                "Variable": "$.a",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    Object {
                      "And": Array [
                        Object {
                          "IsBoolean": true,
                          "Variable": "$.a",
                        },
                        Object {
                          "BooleanEquals": true,
                          "Variable": "$.a",
                        },
                      ],
                    },
                  ],
                },
              ],
            },
            Object {
              "And": Array [
                Object {
                  "IsPresent": true,
                  "Variable": "$.b",
                },
                Object {
                  "IsNull": false,
                  "Variable": "$.b",
                },
                Object {
                  "Or": Array [
                    Object {
                      "And": Array [
                        Object {
                          "IsString": true,
                          "Variable": "$.b",
                        },
                        Object {
                          "Not": Object {
                            "And": Array [
                              Object {
                                "IsString": true,
                                "Variable": "$.b",
                              },
                              Object {
                                "StringEquals": "",
                                "Variable": "$.b",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    Object {
                      "And": Array [
                        Object {
                          "IsNumeric": true,
                          "Variable": "$.b",
                        },
                        Object {
                          "Not": Object {
                            "And": Array [
                              Object {
                                "IsNumeric": true,
                                "Variable": "$.b",
                              },
                              Object {
                                "NumericEquals": 0,
                                "Variable": "$.b",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    Object {
                      "And": Array [
                        Object {
                          "IsBoolean": true,
                          "Variable": "$.b",
                        },
                        Object {
                          "BooleanEquals": true,
                          "Variable": "$.b",
                        },
                      ],
                    },
                  ],
                },
              ],
            },
          ],
          "Next": "assignTrue__return input.a && input.b",
        },
      ],
      "Default": "assignFalse__return input.a && input.b",
      "Type": "Choice",
    },
  },
}
`;

exports[`break from do-while-loop 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "break",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "break": Object {
      "Next": "return null",
      "Type": "Pass",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "while (true)": Object {
      "Choices": Array [
        Object {
          "IsPresent": false,
          "Next": "break",
          "Variable": "$.0_true",
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
  },
}
`;

exports[`break from for-loop 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "for(item of input.items)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "for(item of input.items)": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "Break",
          ],
          "Next": "return null",
          "ResultPath": null,
        },
      ],
      "ItemsPath": "$.items",
      "Iterator": Object {
        "StartAt": "if(item == \\"hello\\")",
        "States": Object {
          "0_empty_else_if(item == \\"hello\\")": Object {
            "End": true,
            "Type": "Pass",
          },
          "break": Object {
            "Error": "Break",
            "Type": "Fail",
          },
          "if(item == \\"hello\\")": Object {
            "Choices": Array [
              Object {
                "Next": "break",
                "StringEquals": "hello",
                "Variable": "$.item",
              },
            ],
            "Default": "0_empty_else_if(item == \\"hello\\")",
            "Type": "Choice",
          },
        },
      },
      "MaxConcurrency": 1,
      "Next": "return null",
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": null,
      "Type": "Map",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`break from while-loop 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "while (true)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "break": Object {
      "Next": "return null",
      "Type": "Pass",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "while (true)": Object {
      "Choices": Array [
        Object {
          "IsPresent": false,
          "Next": "break",
          "Variable": "$.0_true",
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
  },
}
`;

exports[`call AWS.DynamoDB.GetItem, then Lambda and return LiteralExpr 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "person = await $AWS.DynamoDB.GetItem({Table: personTable, Key: {id: {S: inp",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "if(person.Item == undefined)": Object {
      "Choices": Array [
        Object {
          "Next": "return undefined",
          "Or": Array [
            Object {
              "IsPresent": false,
              "Variable": "$.person.Item",
            },
            Object {
              "IsNull": true,
              "Variable": "$.person.Item",
            },
          ],
        },
      ],
      "Default": "score = await computeScore({id: person.Item.id.S, name: person.Item.name.S}",
      "Type": "Choice",
    },
    "person = await $AWS.DynamoDB.GetItem({Table: personTable, Key: {id: {S: inp": Object {
      "Next": "if(person.Item == undefined)",
      "Parameters": Object {
        "Key": Object {
          "id": Object {
            "S.$": "$.id",
          },
        },
        "TableName": "__REPLACED_TOKEN",
      },
      "Resource": "__REPLACED_ARN",
      "ResultPath": "$.person",
      "Type": "Task",
    },
    "return undefined": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "return {id: person.Item.id.S, name: person.Item.name.S, score: score}": Object {
      "End": true,
      "Parameters": Object {
        "id.$": "$.person.Item.id.S",
        "name.$": "$.person.Item.name.S",
        "score.$": "$.score",
      },
      "ResultPath": "$",
      "Type": "Pass",
    },
    "score = await computeScore({id: person.Item.id.S, name: person.Item.name.S}": Object {
      "Next": "return {id: person.Item.id.S, name: person.Item.name.S, score: score}",
      "Parameters": Object {
        "id.$": "$.person.Item.id.S",
        "name.$": "$.person.Item.name.S",
      },
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$.score",
      "Type": "Task",
    },
  },
}
`;

exports[`call Lambda Function, store as variable, return promise variable 1`] = `
Object {
  "StartAt": "person = getPerson({id: input.id})",
  "States": Object {
    "person = getPerson({id: input.id})": Object {
      "Next": "return person",
      "Parameters": Object {
        "FunctionName": "__REPLACED_TOKEN",
        "Payload": Object {
          "id.$": "$.id",
        },
      },
      "Resource": "arn:aws:states:::lambda:invoke",
      "ResultPath": "$.person",
      "ResultSelector": "$.Payload",
      "Type": "Task",
    },
    "return person": Object {
      "End": true,
      "OutputPath": "$.person",
      "Type": "Pass",
    },
  },
}
`;

exports[`call Lambda Function, store as variable, return variable 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "person = await getPerson({id: input.id})",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "person = await getPerson({id: input.id})": Object {
      "Next": "return person",
      "Parameters": Object {
        "id.$": "$.id",
      },
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$.person",
      "Type": "Task",
    },
    "return person": Object {
      "End": true,
      "OutputPath": "$.person",
      "Type": "Pass",
    },
  },
}
`;

exports[`call Lambda Function, store as variable, return variable no block 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return getPerson({id: input.id})",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return getPerson({id: input.id})": Object {
      "End": true,
      "Parameters": Object {
        "id.$": "$.id",
      },
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`call Step Function describe from another Step Function 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return machine1.describeExecution(\\"hello\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return machine1.describeExecution(\\"hello\\")": Object {
      "End": true,
      "Parameters": Object {
        "ExecutionArn": "hello",
      },
      "Resource": "__REPLACED_ARN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`call Step Function describe from another Step Function from context 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return machine1.describeExecution(input.id)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return machine1.describeExecution(input.id)": Object {
      "End": true,
      "Parameters": Object {
        "ExecutionArn.$": "$.id",
      },
      "Resource": "__REPLACED_ARN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`call Step Function from another Step Function 1`] = `
Object {
  "StartAt": "return machine1({})",
  "States": Object {
    "return machine1({})": Object {
      "End": true,
      "Parameters": Object {
        "StateMachineArn": "__REPLACED_TOKEN",
      },
      "Resource": "__REPLACED_ARN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`call Step Function from another Step Function with dynamic input 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return machine1({input: {value: input.value1}})",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return machine1({input: {value: input.value1}})": Object {
      "End": true,
      "Parameters": Object {
        "Input": Object {
          "value.$": "$.value1",
        },
        "StateMachineArn": "__REPLACED_TOKEN",
      },
      "Resource": "__REPLACED_ARN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`call Step Function from another Step Function with dynamic input field input 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return machine1({input: input})",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return machine1({input: input})": Object {
      "End": true,
      "Parameters": Object {
        "Input.$": "$",
        "StateMachineArn": "__REPLACED_TOKEN",
      },
      "Resource": "__REPLACED_ARN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`call Step Function from another Step Function with input 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return machine1({input: {value: \\"hello\\"}})",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return machine1({input: {value: \\"hello\\"}})": Object {
      "End": true,
      "Parameters": Object {
        "Input": Object {
          "value": "hello",
        },
        "StateMachineArn": "__REPLACED_TOKEN",
      },
      "Resource": "__REPLACED_ARN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`call Step Function from another Step Function with name and trace 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return machine1({name: \\"exec1\\", traceHeader: \\"1\\"})",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return machine1({name: \\"exec1\\", traceHeader: \\"1\\"})": Object {
      "End": true,
      "Parameters": Object {
        "Name": "exec1",
        "StateMachineArn": "__REPLACED_TOKEN",
        "TraceHeader": "1",
      },
      "Resource": "__REPLACED_ARN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`call Step Function from another Step Function with name and trace from variables 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return machine1({name: input.name, traceHeader: input.header})",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return machine1({name: input.name, traceHeader: input.header})": Object {
      "End": true,
      "Parameters": Object {
        "Name.$": "$.name",
        "StateMachineArn": "__REPLACED_TOKEN",
        "TraceHeader.$": "$.header",
      },
      "Resource": "__REPLACED_ARN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`catch and throw Error 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "throw Error(\\"cause\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "throw Error(\\"cause\\")": Object {
      "Next": "throw new CustomError(\\"custom cause\\")",
      "Result": Object {
        "message": "cause",
      },
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "throw new CustomError(\\"custom cause\\")": Object {
      "Cause": "{\\"property\\":\\"custom cause\\"}",
      "Error": "CustomError",
      "Type": "Fail",
    },
  },
}
`;

exports[`catch and throw new Error 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "throw new Error(\\"cause\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "throw new CustomError(\\"custom cause\\")": Object {
      "Cause": "{\\"property\\":\\"custom cause\\"}",
      "Error": "CustomError",
      "Type": "Fail",
    },
    "throw new Error(\\"cause\\")": Object {
      "Next": "throw new CustomError(\\"custom cause\\")",
      "Result": Object {
        "message": "cause",
      },
      "ResultPath": "$.err",
      "Type": "Pass",
    },
  },
}
`;

exports[`conditionally call DynamoDB and then void 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "if(input.id == \\"hello\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await $AWS.DynamoDB.GetItem({Table: personTable, Key: {id: {S: input.id}}})": Object {
      "Next": "return null",
      "Parameters": Object {
        "Key": Object {
          "id": Object {
            "S.$": "$.id",
          },
        },
        "TableName": "__REPLACED_TOKEN",
      },
      "Resource": "__REPLACED_ARN",
      "ResultPath": null,
      "Type": "Task",
    },
    "if(input.id == \\"hello\\")": Object {
      "Choices": Array [
        Object {
          "Next": "await $AWS.DynamoDB.GetItem({Table: personTable, Key: {id: {S: input.id}}})",
          "StringEquals": "hello",
          "Variable": "$.id",
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`conditionally return void 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "if(input.id == \\"hello\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "if(input.id == \\"hello\\")": Object {
      "Choices": Array [
        Object {
          "Next": "return null",
          "StringEquals": "hello",
          "Variable": "$.id",
        },
      ],
      "Default": "return null 1",
      "Type": "Choice",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "return null 1": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`continue in do..while loop 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "if(input.key == \\"sam\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await task(input.key)": Object {
      "InputPath": "$.key",
      "Next": "while (true)",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "continue": Object {
      "Next": "if(input.key == \\"sam\\")",
      "ResultPath": null,
      "Type": "Pass",
    },
    "if(input.key == \\"sam\\")": Object {
      "Choices": Array [
        Object {
          "Next": "continue",
          "StringEquals": "sam",
          "Variable": "$.key",
        },
      ],
      "Default": "await task(input.key)",
      "Type": "Choice",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "while (true)": Object {
      "Choices": Array [
        Object {
          "IsPresent": false,
          "Next": "if(input.key == \\"sam\\")",
          "Variable": "$.0_true",
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
  },
}
`;

exports[`continue in for loop 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "for(item of input.items)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "for(item of input.items)": Object {
      "ItemsPath": "$.items",
      "Iterator": Object {
        "StartAt": "if(item == \\"hello\\")",
        "States": Object {
          "0_empty_else_if(item == \\"hello\\")": Object {
            "End": true,
            "Type": "Pass",
          },
          "continue": Object {
            "End": true,
            "ResultPath": null,
            "Type": "Pass",
          },
          "if(item == \\"hello\\")": Object {
            "Choices": Array [
              Object {
                "Next": "continue",
                "StringEquals": "hello",
                "Variable": "$.item",
              },
            ],
            "Default": "0_empty_else_if(item == \\"hello\\")",
            "Type": "Choice",
          },
        },
      },
      "MaxConcurrency": 1,
      "Next": "return null",
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": null,
      "Type": "Map",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`continue in while loop 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "while (true)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await task(input.key)": Object {
      "InputPath": "$.key",
      "Next": "while (true)",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "continue": Object {
      "Next": "while (true)",
      "ResultPath": null,
      "Type": "Pass",
    },
    "if(input.key == \\"sam\\")": Object {
      "Choices": Array [
        Object {
          "Next": "continue",
          "StringEquals": "sam",
          "Variable": "$.key",
        },
      ],
      "Default": "await task(input.key)",
      "Type": "Choice",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "while (true)": Object {
      "Choices": Array [
        Object {
          "IsPresent": false,
          "Next": "if(input.key == \\"sam\\")",
          "Variable": "$.0_true",
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
  },
}
`;

exports[`empty function 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return null",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`for (const i in [task(input)]) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_tmp = await task(input)": Object {
      "InputPath": "$",
      "Next": "1_tmp = [0_tmp]",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$.0_tmp",
      "Type": "Task",
    },
    "1_tmp = [0_tmp]": Object {
      "Next": "for(i in 1_tmp)",
      "Result": "States.Array($.0_tmp)",
      "ResultPath": "$.1_tmp",
      "Type": "Pass",
    },
    "__fnl_constants": Object {
      "Next": "0_tmp = await task(input)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "for(i in 1_tmp)": Object {
      "ItemsPath": "$.1_tmp",
      "Iterator": Object {
        "StartAt": "2_tmp = await task(i)",
        "States": Object {
          "2_tmp = await task(i)": Object {
            "InputPath": "$.i",
            "Next": "await task(2_tmp)",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$.2_tmp",
            "Type": "Task",
          },
          "await task(2_tmp)": Object {
            "End": true,
            "InputPath": "$.2_tmp",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": null,
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 1,
      "Next": "return null",
      "Parameters": Object {
        "0_i.$": "$$.Map.Item.Value",
        "i.$": "$$.Map.Item.Index",
      },
      "ResultPath": null,
      "Type": "Map",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`for (const i of [task(input)]) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_tmp = await task(input)": Object {
      "InputPath": "$",
      "Next": "1_tmp = [0_tmp]",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$.0_tmp",
      "Type": "Task",
    },
    "1_tmp = [0_tmp]": Object {
      "Next": "for(i of 1_tmp)",
      "Result": "States.Array($.0_tmp)",
      "ResultPath": "$.1_tmp",
      "Type": "Pass",
    },
    "__fnl_constants": Object {
      "Next": "0_tmp = await task(input)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "for(i of 1_tmp)": Object {
      "ItemsPath": "$.1_tmp",
      "Iterator": Object {
        "StartAt": "2_tmp = await task(i)",
        "States": Object {
          "2_tmp = await task(i)": Object {
            "InputPath": "$.i",
            "Next": "await task(2_tmp)",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$.2_tmp",
            "Type": "Task",
          },
          "await task(2_tmp)": Object {
            "End": true,
            "InputPath": "$.2_tmp",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": null,
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 1,
      "Next": "return null",
      "Parameters": Object {
        "i.$": "$$.Map.Item.Value",
      },
      "ResultPath": null,
      "Type": "Map",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`for i in items, items[i] 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "for(i in input.items)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "for(i in input.items)": Object {
      "ItemsPath": "$.items",
      "Iterator": Object {
        "StartAt": "a = items[i]",
        "States": Object {
          "a = items[i]": Object {
            "End": true,
            "OutputPath": "$.result",
            "Parameters": Object {
              "result.$": "$.0_i",
            },
            "ResultPath": "$.a",
            "Type": "Pass",
          },
        },
      },
      "MaxConcurrency": 1,
      "Next": "return null",
      "Parameters": Object {
        "0_i.$": "$$.Map.Item.Value",
        "i.$": "$$.Map.Item.Index",
      },
      "ResultPath": null,
      "Type": "Map",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`for-loop and do nothing 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "for(item of input.items)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "for(item of input.items)": Object {
      "ItemsPath": "$.items",
      "Iterator": Object {
        "StartAt": "a = item",
        "States": Object {
          "a = item": Object {
            "End": true,
            "OutputPath": "$.result",
            "Parameters": Object {
              "result.$": "$.item",
            },
            "ResultPath": "$.a",
            "Type": "Pass",
          },
        },
      },
      "MaxConcurrency": 1,
      "Next": "return null",
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": null,
      "Type": "Map",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`for-loop over a list literal 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "people = [\\"sam\\", \\"brendan\\"]",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "for(name of people)": Object {
      "ItemsPath": "$.people",
      "Iterator": Object {
        "StartAt": "await computeScore({id: input.id, name: name})",
        "States": Object {
          "await computeScore({id: input.id, name: name})": Object {
            "End": true,
            "Parameters": Object {
              "id.$": "$.id",
              "name.$": "$.name",
            },
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": null,
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 1,
      "Next": "return null",
      "Parameters": Object {
        "name.$": "$$.Map.Item.Value",
      },
      "ResultPath": null,
      "Type": "Map",
    },
    "people = [\\"sam\\", \\"brendan\\"]": Object {
      "Next": "for(name of people)",
      "Result": Array [
        "sam",
        "brendan",
      ],
      "ResultPath": "$.people",
      "Type": "Pass",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`for-of { try { task() } catch (err) { if(err) throw } finally { task() } } 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "for(item of input.items)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "for(item of input.items)": Object {
      "ItemsPath": "$.items",
      "Iterator": Object {
        "StartAt": "await task(item)",
        "States": Object {
          "0_catch(err)": Object {
            "InputPath": "$.err.0_ParsedError",
            "Next": "if(err.message == \\"you dun' goofed\\")",
            "ResultPath": "$.err",
            "Type": "Pass",
          },
          "await task(\\"2\\")": Object {
            "Next": "exit finally",
            "Parameters": "2",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": null,
            "Type": "Task",
          },
          "await task(item)": Object {
            "Catch": Array [
              Object {
                "ErrorEquals": Array [
                  "States.ALL",
                ],
                "Next": "catch(err)",
                "ResultPath": "$.err",
              },
            ],
            "InputPath": "$.item",
            "Next": "await task(\\"2\\")",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": null,
            "Type": "Task",
          },
          "catch(err)": Object {
            "Next": "0_catch(err)",
            "Parameters": Object {
              "0_ParsedError.$": "States.StringToJson($.err.Cause)",
            },
            "ResultPath": "$.err",
            "Type": "Pass",
          },
          "exit finally": Object {
            "Choices": Array [
              Object {
                "IsPresent": true,
                "Next": "throw finally",
                "Variable": "$.0_tmp",
              },
            ],
            "Default": "return null",
            "Type": "Choice",
          },
          "if(err.message == \\"you dun' goofed\\")": Object {
            "Choices": Array [
              Object {
                "Next": "throw new Error(\\"little\\")",
                "StringEquals": "you dun' goofed",
                "Variable": "$.err.message",
              },
            ],
            "Default": "await task(\\"2\\")",
            "Type": "Choice",
          },
          "throw finally": Object {
            "Cause": "an error was re-thrown from a finally block which is unsupported by Step Functions",
            "Error": "ReThrowFromFinally",
            "Type": "Fail",
          },
          "throw new Error(\\"little\\")": Object {
            "Next": "await task(\\"2\\")",
            "Result": Object {
              "message": "little",
            },
            "ResultPath": "$.0_tmp",
            "Type": "Pass",
          },
        },
      },
      "MaxConcurrency": 1,
      "Next": "return null",
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": null,
      "Type": "Map",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`if (typeof x !== ??) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "if(input.id != undefined)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "if(input.id != undefined)": Object {
      "Choices": Array [
        Object {
          "And": Array [
            Object {
              "IsPresent": true,
              "Variable": "$.id",
            },
            Object {
              "IsNull": false,
              "Variable": "$.id",
            },
          ],
          "Next": "return \\"null\\"",
        },
        Object {
          "IsPresent": true,
          "Next": "return \\"undefined\\"",
          "Variable": "$.id",
        },
        Object {
          "Next": "return \\"string\\"",
          "Or": Array [
            Object {
              "IsPresent": false,
              "Variable": "$.id",
            },
            Object {
              "IsString": false,
              "Variable": "$.id",
            },
          ],
        },
        Object {
          "Next": "return \\"boolean\\"",
          "Or": Array [
            Object {
              "IsPresent": false,
              "Variable": "$.id",
            },
            Object {
              "IsBoolean": false,
              "Variable": "$.id",
            },
          ],
        },
        Object {
          "Next": "return \\"number\\"",
          "Or": Array [
            Object {
              "IsPresent": false,
              "Variable": "$.id",
            },
            Object {
              "IsNumeric": false,
              "Variable": "$.id",
            },
          ],
        },
        Object {
          "Next": "return \\"bigint\\"",
          "Or": Array [
            Object {
              "IsPresent": false,
              "Variable": "$.id",
            },
            Object {
              "IsNumeric": false,
              "Variable": "$.id",
            },
          ],
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
    "return \\"bigint\\"": Object {
      "End": true,
      "Result": "bigint",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"boolean\\"": Object {
      "End": true,
      "Result": "boolean",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"null\\"": Object {
      "End": true,
      "Result": "null",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"number\\"": Object {
      "End": true,
      "Result": "number",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"string\\"": Object {
      "End": true,
      "Result": "string",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"undefined\\"": Object {
      "End": true,
      "Result": "undefined",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`if (typeof x === ??) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "if(input.id == undefined)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "if(input.id == undefined)": Object {
      "Choices": Array [
        Object {
          "Next": "return \\"null\\"",
          "Or": Array [
            Object {
              "IsPresent": false,
              "Variable": "$.id",
            },
            Object {
              "IsNull": true,
              "Variable": "$.id",
            },
          ],
        },
        Object {
          "IsPresent": false,
          "Next": "return \\"undefined\\"",
          "Variable": "$.id",
        },
        Object {
          "And": Array [
            Object {
              "IsPresent": true,
              "Variable": "$.id",
            },
            Object {
              "IsString": true,
              "Variable": "$.id",
            },
          ],
          "Next": "return \\"string\\"",
        },
        Object {
          "And": Array [
            Object {
              "IsPresent": true,
              "Variable": "$.id",
            },
            Object {
              "IsBoolean": true,
              "Variable": "$.id",
            },
          ],
          "Next": "return \\"boolean\\"",
        },
        Object {
          "And": Array [
            Object {
              "IsPresent": true,
              "Variable": "$.id",
            },
            Object {
              "IsNumeric": true,
              "Variable": "$.id",
            },
          ],
          "Next": "return \\"number\\"",
        },
        Object {
          "And": Array [
            Object {
              "IsPresent": true,
              "Variable": "$.id",
            },
            Object {
              "IsNumeric": true,
              "Variable": "$.id",
            },
          ],
          "Next": "return \\"bigint\\"",
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
    "return \\"bigint\\"": Object {
      "End": true,
      "Result": "bigint",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"boolean\\"": Object {
      "End": true,
      "Result": "boolean",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"null\\"": Object {
      "End": true,
      "Result": "null",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"number\\"": Object {
      "End": true,
      "Result": "number",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"string\\"": Object {
      "End": true,
      "Result": "string",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"undefined\\"": Object {
      "End": true,
      "Result": "undefined",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`if-else 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "if(input.id == \\"hello\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "if(input.id == \\"hello\\")": Object {
      "Choices": Array [
        Object {
          "Next": "return \\"hello\\"",
          "StringEquals": "hello",
          "Variable": "$.id",
        },
      ],
      "Default": "return \\"world\\"",
      "Type": "Choice",
    },
    "return \\"hello\\"": Object {
      "End": true,
      "Result": "hello",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"world\\"": Object {
      "End": true,
      "Result": "world",
      "ResultPath": "$",
      "Type": "Pass",
    },
  },
}
`;

exports[`if-else-if 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "if(input.id == \\"hello\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "if(input.id == \\"hello\\")": Object {
      "Choices": Array [
        Object {
          "Next": "return \\"hello\\"",
          "StringEquals": "hello",
          "Variable": "$.id",
        },
        Object {
          "Next": "return \\"world\\"",
          "StringEquals": "world",
          "Variable": "$.id",
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
    "return \\"hello\\"": Object {
      "End": true,
      "Result": "hello",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"world\\"": Object {
      "End": true,
      "Result": "world",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`import from express state machine into machine 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "await machine({input: {id: \\"hi\\"}})",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await machine({input: {id: \\"hi\\"}})": Object {
      "Next": "return null",
      "Parameters": Object {
        "Input": Object {
          "id": "hi",
        },
        "StateMachineArn": "__REPLACED_TOKEN",
      },
      "Resource": "__REPLACED_ARN",
      "ResultPath": null,
      "Type": "Task",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`import from state machine into state machine 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "await machine({input: {id: \\"hi\\"}})",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await machine({input: {id: \\"hi\\"}})": Object {
      "Next": "return null",
      "Parameters": Object {
        "Input": Object {
          "id": "hi",
        },
        "StateMachineArn": "__REPLACED_TOKEN",
      },
      "Resource": "__REPLACED_ARN",
      "ResultPath": null,
      "Type": "Task",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`let and set 1`] = `
Object {
  "StartAt": "a = null",
  "States": Object {
    "a = \\"hello\\"": Object {
      "Next": "a = \\"hello\\" + \\" world\\"",
      "Parameters": "hello",
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = \\"hello\\" + \\" world\\"": Object {
      "Next": "a = \\"hello\\" + 1",
      "Parameters": "hello world",
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = \\"hello\\" + 1": Object {
      "Next": "a = 1 + \\"hello\\"",
      "Parameters": "hello1",
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = \\"hello\\" + [\\"world\\"]": Object {
      "Next": "return a",
      "Parameters": "helloworld",
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = \\"hello\\" + null": Object {
      "Next": "a = [null]",
      "Parameters": "hellonull",
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = \\"hello\\" + true": Object {
      "Next": "a = false + \\"hello\\"",
      "Parameters": "hellotrue",
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = \\"hello\\" + {place: \\"world\\"}": Object {
      "Next": "a = \\"hello\\" + [\\"world\\"]",
      "Parameters": "hello[object Object]",
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = -1": Object {
      "Next": "a = -100",
      "Parameters": -1,
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = -100": Object {
      "Next": "a = 1 + 2",
      "Parameters": -100,
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = 0": Object {
      "Next": "a = -1",
      "Parameters": 0,
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = 1 + \\"hello\\"": Object {
      "Next": "a = \\"hello\\" + true",
      "Parameters": "1hello",
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = 1 + 2": Object {
      "Next": "a = \\"hello\\"",
      "Parameters": 3,
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = [-1]": Object {
      "Next": "a = [true]",
      "Parameters": Array [
        -1,
      ],
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = [1]": Object {
      "Next": "a = [-1]",
      "Parameters": Array [
        1,
      ],
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = [null]": Object {
      "Next": "a = [1]",
      "Parameters": Array [
        null,
      ],
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = [true]": Object {
      "Next": "a = [{key: \\"value\\"}]",
      "Parameters": Array [
        true,
      ],
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = [{key: \\"value\\"}]": Object {
      "Next": "a = {key: \\"value\\"}",
      "Parameters": Array [
        Object {
          "key": "value",
        },
      ],
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = a": Object {
      "InputPath": "$.a",
      "Next": "a = \\"hello\\" + {place: \\"world\\"}",
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = false": Object {
      "Next": "a = 0",
      "Parameters": false,
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = false + \\"hello\\"": Object {
      "Next": "a = null + \\"hello\\"",
      "Parameters": "falsehello",
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = null": Object {
      "Next": "a = true",
      "Parameters": Object {
        "$.a": null,
        "a.$": "$.a",
      },
      "ResultPath": null,
      "Type": "Pass",
    },
    "a = null + \\"hello\\"": Object {
      "Next": "a = \\"hello\\" + null",
      "Parameters": "nullhello",
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = true": Object {
      "Next": "a = false",
      "Parameters": true,
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "a = {key: \\"value\\"}": Object {
      "Next": "a = a",
      "Parameters": Object {
        "key": "value",
      },
      "ResultPath": "$.a",
      "Type": "Pass",
    },
    "return a": Object {
      "End": true,
      "OutputPath": "$.a",
      "Type": "Pass",
    },
  },
}
`;

exports[`let cond; do { cond = task() } while (cond) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "cond = await task()",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "cond = await task()": Object {
      "Next": "while (cond == undefined)",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$.cond",
      "Type": "Task",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "while (cond == undefined)": Object {
      "Choices": Array [
        Object {
          "Next": "cond = await task()",
          "Or": Array [
            Object {
              "IsPresent": false,
              "Variable": "$.cond",
            },
            Object {
              "IsNull": true,
              "Variable": "$.cond",
            },
          ],
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
  },
}
`;

exports[`list.filter(item => item.length > 2).map(item => item) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.list.filter(function(item)).map(function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.list.filter(function(item)).map(function(item))": Object {
      "End": true,
      "ItemsPath": "$.list[?(@.length>2)]",
      "Iterator": Object {
        "StartAt": "return item",
        "States": Object {
          "return item": Object {
            "End": true,
            "OutputPath": "$.item",
            "Type": "Pass",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`list.filter(item => item.length > 2).map(item => item) 2`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.list.filter(function(item)).map(function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.list.filter(function(item)).map(function(item))": Object {
      "End": true,
      "ItemsPath": "$.list[?(@.length>2)]",
      "Iterator": Object {
        "StartAt": "return item",
        "States": Object {
          "return item": Object {
            "End": true,
            "OutputPath": "$.item",
            "Type": "Pass",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`list.filter(item => item.length > 2).map(item => item) 3`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.list.filter(function(item)).map(function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.list.filter(function(item)).map(function(item))": Object {
      "End": true,
      "ItemsPath": "$.list[?(@.length>2)]",
      "Iterator": Object {
        "StartAt": "return item",
        "States": Object {
          "return item": Object {
            "End": true,
            "OutputPath": "$.item",
            "Type": "Pass",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`list.filter(item => item.length > 2).map(item => task(item)) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return Promise.all(input.list.filter(function(item)).map(function(item)))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return Promise.all(input.list.filter(function(item)).map(function(item)))": Object {
      "End": true,
      "ItemsPath": "$.list[?(@.length>2)]",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`list.filter(item => item.length > 2).map(item => task(item)) 2`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return Promise.all(input.list.filter(function(item)).map(function(item)))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return Promise.all(input.list.filter(function(item)).map(function(item)))": Object {
      "End": true,
      "ItemsPath": "$.list[?(@.length>2)]",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`list.filter(item => item.length > 2).map(item => task(item)) 3`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return Promise.all(input.list.filter(function(item)).map(function(item)))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return Promise.all(input.list.filter(function(item)).map(function(item)))": Object {
      "End": true,
      "ItemsPath": "$.list[?(@.length>2)]",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`list.forEach((item, i) => if (i == 0) task(item)) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.list.forEach(function(item, i))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.list.forEach(function(item, i))": Object {
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "if(i == 0)",
        "States": Object {
          "if(i == 0)": Object {
            "Choices": Array [
              Object {
                "Next": "return task(item)",
                "NumericEquals": 0,
                "Variable": "$.i",
              },
            ],
            "Default": "return null",
            "Type": "Choice",
          },
          "return null": Object {
            "End": true,
            "OutputPath": "$.null",
            "Parameters": Object {
              "null": null,
            },
            "Type": "Pass",
          },
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {
        "i.$": "$$.Map.Item.Index",
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`list.forEach((item, i, list) => if (i == 0) task(item) else task(list[0])) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.list.forEach(function(item, i))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.list.forEach(function(item, i))": Object {
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "if(i == 0)",
        "States": Object {
          "if(i == 0)": Object {
            "Choices": Array [
              Object {
                "Next": "return task(item)",
                "NumericEquals": 0,
                "Variable": "$.i",
              },
            ],
            "Default": "return task(input.list[0])",
            "Type": "Choice",
          },
          "return task(input.list[0])": Object {
            "End": true,
            "InputPath": "$.list[0]",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {
        "i.$": "$$.Map.Item.Index",
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`list.forEach(item => task(item)) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.list.forEach(function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.list.forEach(function(item))": Object {
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`list.map((item, i) => if (i == 0) task(item)) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return Promise.all(input.list.map(function(item, i)))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return Promise.all(input.list.map(function(item, i)))": Object {
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "if(i == 0)",
        "States": Object {
          "if(i == 0)": Object {
            "Choices": Array [
              Object {
                "Next": "return task(item)",
                "NumericEquals": 0,
                "Variable": "$.i",
              },
            ],
            "Default": "return null",
            "Type": "Choice",
          },
          "return null": Object {
            "End": true,
            "OutputPath": "$.null",
            "Parameters": Object {
              "null": null,
            },
            "Type": "Pass",
          },
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {
        "i.$": "$$.Map.Item.Index",
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`list.map((item, i, list) => if (i == 0) task(item) else task(list[0])) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return Promise.all(input.list.map(function(item, i)))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return Promise.all(input.list.map(function(item, i)))": Object {
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "if(i == 0)",
        "States": Object {
          "if(i == 0)": Object {
            "Choices": Array [
              Object {
                "Next": "return task(item)",
                "NumericEquals": 0,
                "Variable": "$.i",
              },
            ],
            "Default": "return task(input.list[0])",
            "Type": "Choice",
          },
          "return task(input.list[0])": Object {
            "End": true,
            "InputPath": "$.list[0]",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {
        "i.$": "$$.Map.Item.Index",
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`list.map(item => task(item)) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return Promise.all(input.list.map(function(item)))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return Promise.all(input.list.map(function(item)))": Object {
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`nested try-catch 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "throw new Error(\\"error1\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "throw new Error(\\"error1\\")": Object {
      "Next": "throw new Error(\\"error2\\")",
      "Result": Object {
        "message": "error1",
      },
      "ResultPath": null,
      "Type": "Pass",
    },
    "throw new Error(\\"error2\\")": Object {
      "Next": "throw new Error(\\"error3\\")",
      "Result": Object {
        "message": "error2",
      },
      "ResultPath": null,
      "Type": "Pass",
    },
    "throw new Error(\\"error3\\")": Object {
      "Cause": "{\\"message\\":\\"error3\\"}",
      "Error": "Error",
      "Type": "Fail",
    },
  },
}
`;

exports[`null coalesce logic 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_tmp = input.a ?? input.b": Object {
      "Choices": Array [
        Object {
          "And": Array [
            Object {
              "IsPresent": true,
              "Variable": "$.a",
            },
            Object {
              "IsNull": false,
              "Variable": "$.a",
            },
          ],
          "Next": "takeLeft__0_tmp = input.a ?? input.b",
        },
      ],
      "Default": "takeRight__0_tmp = input.a ?? input.b",
      "Type": "Choice",
    },
    "__fnl_constants": Object {
      "Next": "0_tmp = input.a ?? input.b",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return {null: 0_tmp}": Object {
      "End": true,
      "Parameters": Object {
        "null.$": "$.0_tmp",
      },
      "ResultPath": "$",
      "Type": "Pass",
    },
    "takeLeft__0_tmp = input.a ?? input.b": Object {
      "InputPath": "$.a",
      "Next": "return {null: 0_tmp}",
      "ResultPath": "$.0_tmp",
      "Type": "Pass",
    },
    "takeRight__0_tmp = input.a ?? input.b": Object {
      "InputPath": "$.b",
      "Next": "return {null: 0_tmp}",
      "ResultPath": "$.0_tmp",
      "Type": "Pass",
    },
  },
}
`;

exports[`put an event bus event 1`] = `
Object {
  "StartAt": "await bus.putEvents({detail-type: \\"someEvent\\", source: \\"sfnTest\\", detail: {",
  "States": Object {
    "await bus.putEvents({detail-type: \\"someEvent\\", source: \\"sfnTest\\", detail: {": Object {
      "Next": "return null",
      "Parameters": Object {
        "Entries": Array [
          Object {
            "Detail": Object {
              "value.$": "$.id",
            },
            "DetailType": "someEvent",
            "EventBusName": "__REPLACED_TOKEN",
            "Source": "sfnTest",
          },
        ],
      },
      "Resource": "__REPLACED_ARN",
      "ResultPath": null,
      "Type": "Task",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`put multiple event bus events 1`] = `
Object {
  "StartAt": "await bus.putEvents({detail-type: \\"someEvent\\", source: \\"sfnTest\\", detail: {",
  "States": Object {
    "await bus.putEvents({detail-type: \\"someEvent\\", source: \\"sfnTest\\", detail: {": Object {
      "Next": "return null",
      "Parameters": Object {
        "Entries": Array [
          Object {
            "Detail": Object {
              "value.$": "$.id",
            },
            "DetailType": "someEvent",
            "EventBusName": "__REPLACED_TOKEN",
            "Source": "sfnTest",
          },
          Object {
            "Detail": Object {
              "constant": "hi",
              "value.$": "$.id",
            },
            "DetailType": "someOtherEvent",
            "EventBusName": "__REPLACED_TOKEN",
            "Source": "sfnTest",
          },
        ],
      },
      "Resource": "__REPLACED_ARN",
      "ResultPath": null,
      "Type": "Task",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`result = $SFN.forEach(list, (item) => task(item)) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return $SFN.forEach(input.list, function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return $SFN.forEach(input.list, function(item))": Object {
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`result = $SFN.map(list, (item) => task(item)) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "result = await $SFN.map(input.list, function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "result = await $SFN.map(input.list, function(item))": Object {
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "Next": "return result",
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$.result",
      "Type": "Map",
    },
    "return result": Object {
      "End": true,
      "OutputPath": "$.result",
      "Type": "Pass",
    },
  },
}
`;

exports[`return $SFN.forEach(list, (item) => task(item)) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return $SFN.forEach(input.list, function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return $SFN.forEach(input.list, function(item))": Object {
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "await task(item)",
        "States": Object {
          "await task(item)": Object {
            "InputPath": "$.item",
            "Next": "return null",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": null,
            "Type": "Task",
          },
          "return null": Object {
            "End": true,
            "OutputPath": "$.null",
            "Parameters": Object {
              "null": null,
            },
            "Type": "Pass",
          },
        },
      },
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`return $SFN.forEach(list, (item) => try { task(item)) } catch { return null } 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return $SFN.forEach(input.list, function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return $SFN.forEach(input.list, function(item))": Object {
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "await task(item)",
        "States": Object {
          "await task(item)": Object {
            "Catch": Array [
              Object {
                "ErrorEquals": Array [
                  "States.ALL",
                ],
                "Next": "return null 1",
                "ResultPath": null,
              },
            ],
            "InputPath": "$.item",
            "Next": "return null",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": null,
            "Type": "Task",
          },
          "return null": Object {
            "End": true,
            "OutputPath": "$.null",
            "Parameters": Object {
              "null": null,
            },
            "Type": "Pass",
          },
          "return null 1": Object {
            "End": true,
            "OutputPath": "$.null",
            "Parameters": Object {
              "null": null,
            },
            "Type": "Pass",
          },
        },
      },
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`return $SFN.forEach(list, {maxConcurrency: 2} (item) => task(item)) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return $SFN.forEach(input.list, {maxConcurrency: 2}, function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return $SFN.forEach(input.list, {maxConcurrency: 2}, function(item))": Object {
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "await task(item)",
        "States": Object {
          "await task(item)": Object {
            "InputPath": "$.item",
            "Next": "return null",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": null,
            "Type": "Task",
          },
          "return null": Object {
            "End": true,
            "OutputPath": "$.null",
            "Parameters": Object {
              "null": null,
            },
            "Type": "Pass",
          },
        },
      },
      "MaxConcurrency": 2,
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`return $SFN.map(list, (item) => task(item)) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return $SFN.map(input.list, function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return $SFN.map(input.list, function(item))": Object {
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`return $SFN.map(list, (item) => try { task(item)) } catch { return null } 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return $SFN.map(input.list, function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return $SFN.map(input.list, function(item))": Object {
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return null": Object {
            "End": true,
            "OutputPath": "$.null",
            "Parameters": Object {
              "null": null,
            },
            "Type": "Pass",
          },
          "return task(item)": Object {
            "Catch": Array [
              Object {
                "ErrorEquals": Array [
                  "States.ALL",
                ],
                "Next": "return null",
                "ResultPath": null,
              },
            ],
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`return $SFN.map(list, {maxConcurrency: 2} (item) => task(item)) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return $SFN.map(input.list, {maxConcurrency: 2}, function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return $SFN.map(input.list, {maxConcurrency: 2}, function(item))": Object {
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 2,
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`return $SFN.parallel(() => "hello", () => "world")) 1`] = `
Object {
  "StartAt": "return $SFN.parallel([function(), function()])",
  "States": Object {
    "return $SFN.parallel([function(), function()])": Object {
      "Branches": Array [
        Object {
          "StartAt": "return \\"hello\\"",
          "States": Object {
            "return \\"hello\\"": Object {
              "End": true,
              "Result": "hello",
              "ResultPath": "$",
              "Type": "Pass",
            },
          },
        },
        Object {
          "StartAt": "return \\"world\\"",
          "States": Object {
            "return \\"world\\"": Object {
              "End": true,
              "Result": "world",
              "ResultPath": "$",
              "Type": "Pass",
            },
          },
        },
      ],
      "End": true,
      "ResultPath": "$",
      "Type": "Parallel",
    },
  },
}
`;

exports[`return $SFN.parallel(() => try { task() } catch { return null })) } 1`] = `
Object {
  "StartAt": "return $SFN.parallel([function()])",
  "States": Object {
    "return $SFN.parallel([function()])": Object {
      "Branches": Array [
        Object {
          "StartAt": "return task()",
          "States": Object {
            "return null": Object {
              "End": true,
              "OutputPath": "$.null",
              "Parameters": Object {
                "null": null,
              },
              "Type": "Pass",
            },
            "return task()": Object {
              "Catch": Array [
                Object {
                  "ErrorEquals": Array [
                    "States.ALL",
                  ],
                  "Next": "return null",
                  "ResultPath": null,
                },
              ],
              "End": true,
              "Resource": "__REPLACED_TOKEN",
              "ResultPath": "$",
              "Type": "Task",
            },
          },
        },
      ],
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "return null 1",
          "ResultPath": null,
        },
      ],
      "End": true,
      "ResultPath": "$",
      "Type": "Parallel",
    },
    "return null 1": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`return AWS.DynamoDB.GetItem 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "person = await $AWS.DynamoDB.GetItem({Table: personTable, Key: {id: {S: inp",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "if(person.Item == undefined)": Object {
      "Choices": Array [
        Object {
          "Next": "return undefined",
          "Or": Array [
            Object {
              "IsPresent": false,
              "Variable": "$.person.Item",
            },
            Object {
              "IsNull": true,
              "Variable": "$.person.Item",
            },
          ],
        },
      ],
      "Default": "return {id: person.Item.id.S, name: person.Item.name.S}",
      "Type": "Choice",
    },
    "person = await $AWS.DynamoDB.GetItem({Table: personTable, Key: {id: {S: inp": Object {
      "Next": "if(person.Item == undefined)",
      "Parameters": Object {
        "Key": Object {
          "id": Object {
            "S.$": "$.id",
          },
        },
        "TableName": "__REPLACED_TOKEN",
      },
      "Resource": "__REPLACED_ARN",
      "ResultPath": "$.person",
      "Type": "Task",
    },
    "return undefined": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "return {id: person.Item.id.S, name: person.Item.name.S}": Object {
      "End": true,
      "Parameters": Object {
        "id.$": "$.person.Item.id.S",
        "name.$": "$.person.Item.name.S",
      },
      "ResultPath": "$",
      "Type": "Pass",
    },
  },
}
`;

exports[`return PropAccessExpr 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.input.id",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.input.id": Object {
      "End": true,
      "OutputPath": "$.input.id",
      "Type": "Pass",
    },
  },
}
`;

exports[`return a single Lambda Function call 1`] = `
Object {
  "StartAt": "return getPerson({id: input.id})",
  "States": Object {
    "return getPerson({id: input.id})": Object {
      "End": true,
      "Parameters": Object {
        "id.$": "$.id",
      },
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`return await task(await task()) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_tmp = await task()": Object {
      "Next": "return task(0_tmp)",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$.0_tmp",
      "Type": "Task",
    },
    "__fnl_constants": Object {
      "Next": "0_tmp = await task()",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return task(0_tmp)": Object {
      "End": true,
      "InputPath": "$.0_tmp",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`return identifier 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.id",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.id": Object {
      "End": true,
      "OutputPath": "$.id",
      "Type": "Pass",
    },
  },
}
`;

exports[`return items.slice(-1) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.items.slice(-1)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.items.slice(-1)": Object {
      "End": true,
      "InputPath": "$.items[-1:]",
      "ResultPath": "$",
      "Type": "Pass",
    },
  },
}
`;

exports[`return items.slice(0, -1) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.items.slice(0, -1)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.items.slice(0, -1)": Object {
      "End": true,
      "InputPath": "$.items[0:-1]",
      "ResultPath": "$",
      "Type": "Pass",
    },
  },
}
`;

exports[`return items.slice(1) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.items.slice(1)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.items.slice(1)": Object {
      "End": true,
      "InputPath": "$.items[1:]",
      "ResultPath": "$",
      "Type": "Pass",
    },
  },
}
`;

exports[`return items.slice(1, 3) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.items.slice(1, 3)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.items.slice(1, 3)": Object {
      "End": true,
      "InputPath": "$.items[1:3]",
      "ResultPath": "$",
      "Type": "Pass",
    },
  },
}
`;

exports[`return items.slice(1, undefined) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.items.slice(1, undefined)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.items.slice(1, undefined)": Object {
      "End": true,
      "InputPath": "$.items[1:]",
      "ResultPath": "$",
      "Type": "Pass",
    },
  },
}
`;

exports[`return optional PropAccessExpr 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.input.id",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.input.id": Object {
      "End": true,
      "OutputPath": "$.input.id",
      "Type": "Pass",
    },
  },
}
`;

exports[`return task({ key: items.filter(*) }) 1`] = `
Object {
  "StartAt": "return task({equals: input.items.filter(function(item)), and: input.items.f",
  "States": Object {
    "return task({equals: input.items.filter(function(item)), and: input.items.f": Object {
      "End": true,
      "Parameters": Object {
        "and.$": "$.items[?(@.str=='hello'&&@.items[0]=='hello')]",
        "equals.$": "$.items[?(@.str=='hello')]",
        "or.$": "$.items[?(@.str=='hello'||@.items[0]=='hello')]",
      },
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`return task({key: items.slice(1, 3)}) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return task({key: input.items.slice(1, 3)})",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return task({key: input.items.slice(1, 3)})": Object {
      "End": true,
      "Parameters": Object {
        "key.$": "$.items[1:3]",
      },
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`return task(await task()) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_tmp = await task()": Object {
      "Next": "return task(0_tmp)",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$.0_tmp",
      "Type": "Task",
    },
    "__fnl_constants": Object {
      "Next": "0_tmp = await task()",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return task(0_tmp)": Object {
      "End": true,
      "InputPath": "$.0_tmp",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`return void 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return null",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`single quotes in StringLiteralExpr should be escaped in a JSON Path filter expression 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return task({escape: input.items.filter(function(item))})",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return task({escape: input.items.filter(function(item))})": Object {
      "End": true,
      "Parameters": Object {
        "escape.$": "$.items[?(@.str=='hello\\\\'world')]",
      },
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`spread constant array and object 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_tmp = [0, ...array, 3]": Object {
      "Next": "return {array: 0_tmp, object: {key: \\"value\\", ...object}}",
      "Result": Array [
        0,
        1,
        2,
        3,
      ],
      "ResultPath": "$.0_tmp",
      "Type": "Pass",
    },
    "__fnl_constants": Object {
      "Next": "0_tmp = [0, ...array, 3]",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return {array: 0_tmp, object: {key: \\"value\\", ...object}}": Object {
      "End": true,
      "Parameters": Object {
        "array.$": "$.0_tmp",
        "object": Object {
          "hello": "world",
          "key": "value",
        },
      },
      "ResultPath": "$",
      "Type": "Pass",
    },
  },
}
`;

exports[`task(-1) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return task(-1)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return task(-1)": Object {
      "End": true,
      "Parameters": -1,
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`task(any) 1`] = `
Object {
  "StartAt": "await task(null)",
  "States": Object {
    "await task(\\"hello\\" + \\" world\\")": Object {
      "Next": "await task(\\"hello\\" + 1)",
      "Parameters": "hello world",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(\\"hello\\" + 1)": Object {
      "Next": "await task(1 + \\"hello\\")",
      "Parameters": "hello1",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(\\"hello\\" + [\\"world\\"])": Object {
      "Next": "return null",
      "Parameters": "helloworld",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(\\"hello\\" + null)": Object {
      "Next": "await task([null])",
      "Parameters": "hellonull",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(\\"hello\\" + true)": Object {
      "Next": "await task(false + \\"hello\\")",
      "Parameters": "hellotrue",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(\\"hello\\" + {place: \\"world\\"})": Object {
      "Next": "await task(\\"hello\\" + [\\"world\\"])",
      "Parameters": "hello[object Object]",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(\\"hello\\")": Object {
      "Next": "await task(\\"hello\\" + \\" world\\")",
      "Parameters": "hello",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(-1)": Object {
      "Next": "await task(-100)",
      "Parameters": -1,
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(-100)": Object {
      "Next": "await task(1 + 2)",
      "Parameters": -100,
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(0)": Object {
      "Next": "await task(-1)",
      "Parameters": 0,
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(1 + \\"hello\\")": Object {
      "Next": "await task(\\"hello\\" + true)",
      "Parameters": "1hello",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(1 + 2)": Object {
      "Next": "await task(\\"hello\\")",
      "Parameters": 3,
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task([-1])": Object {
      "Next": "await task([true])",
      "Parameters": Array [
        -1,
      ],
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task([1])": Object {
      "Next": "await task([-1])",
      "Parameters": Array [
        1,
      ],
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task([null])": Object {
      "Next": "await task([1])",
      "Parameters": Array [
        null,
      ],
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task([true])": Object {
      "Next": "await task([{key: \\"value\\"}])",
      "Parameters": Array [
        true,
      ],
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task([{key: \\"value\\"}])": Object {
      "Next": "await task({key: \\"value\\"})",
      "Parameters": Array [
        Object {
          "key": "value",
        },
      ],
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(false + \\"hello\\")": Object {
      "Next": "await task(null + \\"hello\\")",
      "Parameters": "falsehello",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(false)": Object {
      "Next": "await task(0)",
      "Parameters": false,
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(null + \\"hello\\")": Object {
      "Next": "await task(\\"hello\\" + null)",
      "Parameters": "nullhello",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(null)": Object {
      "Next": "await task(true)",
      "Parameters": null,
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(true)": Object {
      "Next": "await task(false)",
      "Parameters": true,
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task({key: \\"value\\"})": Object {
      "Next": "await task(\\"hello\\" + {place: \\"world\\"})",
      "Parameters": Object {
        "key": "value",
      },
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`task(input.list[-1]) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return task(input.list[-1])",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return task(input.list[-1])": Object {
      "End": true,
      "InputPath": "$.list[-1]",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`template literal strings 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return task({key: \`input.obj.str hello input.obj.items[0]\`})",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return task({key: \`input.obj.str hello input.obj.items[0]\`})": Object {
      "End": true,
      "Parameters": Object {
        "key.$": "States.Format('{} hello {}',$.obj.str,$.obj.items[0])",
      },
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`throw Error 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "throw Error(\\"cause\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "throw Error(\\"cause\\")": Object {
      "Cause": "{\\"message\\":\\"cause\\"}",
      "Error": "Error",
      "Type": "Fail",
    },
  },
}
`;

exports[`throw in for-of 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "for(item of input.items)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "for(item of input.items)": Object {
      "ItemsPath": "$.items",
      "Iterator": Object {
        "StartAt": "throw new Error(\\"err\\")",
        "States": Object {
          "throw new Error(\\"err\\")": Object {
            "Cause": "{\\"message\\":\\"err\\"}",
            "Error": "Error",
            "Type": "Fail",
          },
        },
      },
      "MaxConcurrency": 1,
      "Next": "return null",
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": null,
      "Type": "Map",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`throw new CustomError 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "throw new CustomError(\\"cause\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "throw new CustomError(\\"cause\\")": Object {
      "Cause": "{\\"property\\":\\"cause\\"}",
      "Error": "CustomError",
      "Type": "Fail",
    },
  },
}
`;

exports[`throw new Error 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "throw new Error(\\"cause\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "throw new Error(\\"cause\\")": Object {
      "Cause": "{\\"message\\":\\"cause\\"}",
      "Error": "Error",
      "Type": "Fail",
    },
  },
}
`;

exports[`throw task(task()) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_tmp = await task(input)": Object {
      "InputPath": "$",
      "Next": "throw await task(0_tmp)",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$.0_tmp",
      "Type": "Task",
    },
    "__fnl_constants": Object {
      "Next": "0_tmp = await task(input)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "throw await task(0_tmp)": Object {
      "Cause": "{\\"payload\\":\\"$.0_tmp\\"}",
      "Error": "task(0_tmp)",
      "Type": "Fail",
    },
  },
}
`;

exports[`try { $SFN.forEach(list, (item) => task(item)) } catch { return null } 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return $SFN.forEach(input.list, function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return $SFN.forEach(input.list, function(item))": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "return null",
          "ResultPath": null,
        },
      ],
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`try { $SFN.map(list, (item) => task(item)) } catch { return null } 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return $SFN.map(input.list, function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return $SFN.map(input.list, function(item))": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "return null",
          "ResultPath": null,
        },
      ],
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`try { for-of } catch { (maybe) throw } finally { task } 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_catch(err)": Object {
      "InputPath": "$.err.0_ParsedError",
      "Next": "if(err.message == \\"you dun' goofed\\")",
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "__fnl_constants": Object {
      "Next": "for(item of input.items)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await task(\\"2\\")": Object {
      "Next": "exit finally",
      "Parameters": "2",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "catch(err)": Object {
      "Next": "0_catch(err)",
      "Parameters": Object {
        "0_ParsedError.$": "States.StringToJson($.err.Cause)",
      },
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "exit finally": Object {
      "Choices": Array [
        Object {
          "IsPresent": true,
          "Next": "throw finally",
          "Variable": "$.0_tmp",
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
    "for(item of input.items)": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "catch(err)",
          "ResultPath": "$.err",
        },
      ],
      "ItemsPath": "$.items",
      "Iterator": Object {
        "StartAt": "await task(item)",
        "States": Object {
          "await task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": null,
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 1,
      "Next": "await task(\\"2\\")",
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": null,
      "Type": "Map",
    },
    "if(err.message == \\"you dun' goofed\\")": Object {
      "Choices": Array [
        Object {
          "Next": "throw new Error(\\"little\\")",
          "StringEquals": "you dun' goofed",
          "Variable": "$.err.message",
        },
      ],
      "Default": "await task(\\"2\\")",
      "Type": "Choice",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "throw finally": Object {
      "Cause": "an error was re-thrown from a finally block which is unsupported by Step Functions",
      "Error": "ReThrowFromFinally",
      "Type": "Fail",
    },
    "throw new Error(\\"little\\")": Object {
      "Next": "await task(\\"2\\")",
      "Result": Object {
        "message": "little",
      },
      "ResultPath": "$.0_tmp",
      "Type": "Pass",
    },
  },
}
`;

exports[`try { list.forEach(item => task(item)) } 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.list.forEach(function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.list.forEach(function(item))": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "return null",
          "ResultPath": null,
        },
      ],
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`try { list.forEach(item => task(item)) } 2`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.list.forEach(function(item))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.list.forEach(function(item))": Object {
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return null": Object {
            "End": true,
            "OutputPath": "$.null",
            "Parameters": Object {
              "null": null,
            },
            "Type": "Pass",
          },
          "return task(item)": Object {
            "Catch": Array [
              Object {
                "ErrorEquals": Array [
                  "States.ALL",
                ],
                "Next": "return null",
                "ResultPath": null,
              },
            ],
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`try { list.forEach(item => throw) } 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.list.forEach(function())",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.list.forEach(function())": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "return null",
          "ResultPath": null,
        },
      ],
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "throw new Error(\\"cause\\")",
        "States": Object {
          "throw new Error(\\"cause\\")": Object {
            "Cause": "{\\"message\\":\\"cause\\"}",
            "Error": "Error",
            "Type": "Fail",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {},
      "ResultPath": "$",
      "Type": "Map",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`try { list.forEach(item => throw) } catch (err) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_catch(err)": Object {
      "InputPath": "$.err.0_ParsedError",
      "Next": "if(err.message == \\"cause\\")",
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "__fnl_constants": Object {
      "Next": "return input.list.forEach(function())",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "catch(err)": Object {
      "Next": "0_catch(err)",
      "Parameters": Object {
        "0_ParsedError.$": "States.StringToJson($.err.Cause)",
      },
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "if(err.message == \\"cause\\")": Object {
      "Choices": Array [
        Object {
          "Next": "return 0",
          "StringEquals": "cause",
          "Variable": "$.err.message",
        },
      ],
      "Default": "return 1",
      "Type": "Choice",
    },
    "return 0": Object {
      "End": true,
      "Result": 0,
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return 1": Object {
      "End": true,
      "Result": 1,
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return input.list.forEach(function())": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "catch(err)",
          "ResultPath": "$.err",
        },
      ],
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "throw new Error(\\"cause\\")",
        "States": Object {
          "throw new Error(\\"cause\\")": Object {
            "Cause": "{\\"message\\":\\"cause\\"}",
            "Error": "Error",
            "Type": "Fail",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {},
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`try { list.map(item => task(item)) } 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return await Promise.all(input.list.map(function(item)))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return await Promise.all(input.list.map(function(item)))": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "return null",
          "ResultPath": null,
        },
      ],
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return task(item)": Object {
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`try { list.map(item => task(item)) } 2`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return Promise.all(input.list.map(function(item)))",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return Promise.all(input.list.map(function(item)))": Object {
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "return task(item)",
        "States": Object {
          "return null": Object {
            "End": true,
            "OutputPath": "$.null",
            "Parameters": Object {
              "null": null,
            },
            "Type": "Pass",
          },
          "return task(item)": Object {
            "Catch": Array [
              Object {
                "ErrorEquals": Array [
                  "States.ALL",
                ],
                "Next": "return null",
                "ResultPath": null,
              },
            ],
            "End": true,
            "InputPath": "$.item",
            "Resource": "__REPLACED_TOKEN",
            "ResultPath": "$",
            "Type": "Task",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`try { list.map(item => throw) } 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "return input.list.map(function())",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return input.list.map(function())": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "return null",
          "ResultPath": null,
        },
      ],
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "throw new Error(\\"cause\\")",
        "States": Object {
          "throw new Error(\\"cause\\")": Object {
            "Cause": "{\\"message\\":\\"cause\\"}",
            "Error": "Error",
            "Type": "Fail",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {},
      "ResultPath": "$",
      "Type": "Map",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`try { list.map(item => throw) } catch (err) 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_catch(err)": Object {
      "InputPath": "$.err.0_ParsedError",
      "Next": "if(err.message == \\"cause\\")",
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "__fnl_constants": Object {
      "Next": "return input.list.map(function())",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "catch(err)": Object {
      "Next": "0_catch(err)",
      "Parameters": Object {
        "0_ParsedError.$": "States.StringToJson($.err.Cause)",
      },
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "if(err.message == \\"cause\\")": Object {
      "Choices": Array [
        Object {
          "Next": "return 0",
          "StringEquals": "cause",
          "Variable": "$.err.message",
        },
      ],
      "Default": "return 1",
      "Type": "Choice",
    },
    "return 0": Object {
      "End": true,
      "Result": 0,
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return 1": Object {
      "End": true,
      "Result": 1,
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return input.list.map(function())": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "catch(err)",
          "ResultPath": "$.err",
        },
      ],
      "End": true,
      "ItemsPath": "$.list",
      "Iterator": Object {
        "StartAt": "throw new Error(\\"cause\\")",
        "States": Object {
          "throw new Error(\\"cause\\")": Object {
            "Cause": "{\\"message\\":\\"cause\\"}",
            "Error": "Error",
            "Type": "Fail",
          },
        },
      },
      "MaxConcurrency": 1,
      "Parameters": Object {},
      "ResultPath": "$",
      "Type": "Map",
    },
  },
}
`;

exports[`try { return $SFN.parallel(() => "hello", () => "world")) } catch { return null } 1`] = `
Object {
  "StartAt": "return $SFN.parallel([function(), function()])",
  "States": Object {
    "return $SFN.parallel([function(), function()])": Object {
      "Branches": Array [
        Object {
          "StartAt": "return \\"hello\\"",
          "States": Object {
            "return \\"hello\\"": Object {
              "End": true,
              "Result": "hello",
              "ResultPath": "$",
              "Type": "Pass",
            },
          },
        },
        Object {
          "StartAt": "return \\"world\\"",
          "States": Object {
            "return \\"world\\"": Object {
              "End": true,
              "Result": "world",
              "ResultPath": "$",
              "Type": "Pass",
            },
          },
        },
      ],
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "return null",
          "ResultPath": null,
        },
      ],
      "End": true,
      "ResultPath": "$",
      "Type": "Parallel",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`try { return $SFN.parallel(() => "hello", async () => { await task(); await task(); })) } catch { return null } 1`] = `
Object {
  "StartAt": "return $SFN.parallel([function(), function()])",
  "States": Object {
    "return $SFN.parallel([function(), function()])": Object {
      "Branches": Array [
        Object {
          "StartAt": "return \\"hello\\"",
          "States": Object {
            "return \\"hello\\"": Object {
              "End": true,
              "Result": "hello",
              "ResultPath": "$",
              "Type": "Pass",
            },
          },
        },
        Object {
          "StartAt": "await task()",
          "States": Object {
            "await task()": Object {
              "Next": "await task() 1",
              "Resource": "__REPLACED_TOKEN",
              "ResultPath": null,
              "Type": "Task",
            },
            "await task() 1": Object {
              "Next": "return null",
              "Resource": "__REPLACED_TOKEN",
              "ResultPath": null,
              "Type": "Task",
            },
            "return null": Object {
              "End": true,
              "OutputPath": "$.null",
              "Parameters": Object {
                "null": null,
              },
              "Type": "Pass",
            },
          },
        },
      ],
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "return null 1",
          "ResultPath": null,
        },
      ],
      "End": true,
      "ResultPath": "$",
      "Type": "Parallel",
    },
    "return null 1": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`try { task } catch { throw } finally { task() } 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "await task()",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await task(\\"recover\\")": Object {
      "Next": "exit finally",
      "Parameters": "recover",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task()": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "throw new Error(\\"cause\\")",
          "ResultPath": null,
        },
      ],
      "Next": "await task(\\"recover\\")",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "exit finally": Object {
      "Choices": Array [
        Object {
          "IsPresent": true,
          "Next": "throw finally",
          "Variable": "$.0_tmp",
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "throw finally": Object {
      "Cause": "an error was re-thrown from a finally block which is unsupported by Step Functions",
      "Error": "ReThrowFromFinally",
      "Type": "Fail",
    },
    "throw new Error(\\"cause\\")": Object {
      "Next": "await task(\\"recover\\")",
      "Result": Object {
        "message": "cause",
      },
      "ResultPath": "$.0_tmp",
      "Type": "Pass",
    },
  },
}
`;

exports[`try { task() } catch { (maybe) throw } finally { task } 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "await task(\\"1\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await task(\\"1\\")": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "if(input.id == \\"sam\\")",
          "ResultPath": null,
        },
      ],
      "Next": "await task(\\"2\\")",
      "Parameters": "1",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(\\"2\\")": Object {
      "Next": "exit finally",
      "Parameters": "2",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "exit finally": Object {
      "Choices": Array [
        Object {
          "IsPresent": true,
          "Next": "throw finally",
          "Variable": "$.0_tmp",
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
    "if(input.id == \\"sam\\")": Object {
      "Choices": Array [
        Object {
          "Next": "throw new Error(\\"little\\")",
          "StringEquals": "sam",
          "Variable": "$.id",
        },
      ],
      "Default": "await task(\\"2\\")",
      "Type": "Choice",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "throw finally": Object {
      "Cause": "an error was re-thrown from a finally block which is unsupported by Step Functions",
      "Error": "ReThrowFromFinally",
      "Type": "Fail",
    },
    "throw new Error(\\"little\\")": Object {
      "Next": "await task(\\"2\\")",
      "Result": Object {
        "message": "little",
      },
      "ResultPath": "$.0_tmp",
      "Type": "Pass",
    },
  },
}
`;

exports[`try { task() } catch { task() } finally { task() } 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "await task(\\"1\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await task(\\"1\\")": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "await task(\\"2\\")",
          "ResultPath": null,
        },
      ],
      "Next": "await task(\\"3\\")",
      "Parameters": "1",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(\\"2\\")": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "await task(\\"3\\")",
          "ResultPath": "$.0_tmp",
        },
      ],
      "Next": "await task(\\"3\\")",
      "Parameters": "2",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(\\"3\\")": Object {
      "Next": "exit finally",
      "Parameters": "3",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "exit finally": Object {
      "Choices": Array [
        Object {
          "IsPresent": true,
          "Next": "throw finally",
          "Variable": "$.0_tmp",
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "throw finally": Object {
      "Cause": "an error was re-thrown from a finally block which is unsupported by Step Functions",
      "Error": "ReThrowFromFinally",
      "Type": "Fail",
    },
  },
}
`;

exports[`try { task() } catch(err) { (maybe) throw } finally { task } 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_catch(err)": Object {
      "InputPath": "$.err.0_ParsedError",
      "Next": "if(err.message == \\"sam\\")",
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "__fnl_constants": Object {
      "Next": "await task(\\"1\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await task(\\"1\\")": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "catch(err)",
          "ResultPath": "$.err",
        },
      ],
      "Next": "await task(\\"2\\")",
      "Parameters": "1",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "await task(\\"2\\")": Object {
      "Next": "exit finally",
      "Parameters": "2",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "catch(err)": Object {
      "Next": "0_catch(err)",
      "Parameters": Object {
        "0_ParsedError.$": "States.StringToJson($.err.Cause)",
      },
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "exit finally": Object {
      "Choices": Array [
        Object {
          "IsPresent": true,
          "Next": "throw finally",
          "Variable": "$.0_tmp",
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
    "if(err.message == \\"sam\\")": Object {
      "Choices": Array [
        Object {
          "Next": "throw new Error(\\"little\\")",
          "StringEquals": "sam",
          "Variable": "$.err.message",
        },
      ],
      "Default": "await task(\\"2\\")",
      "Type": "Choice",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "throw finally": Object {
      "Cause": "an error was re-thrown from a finally block which is unsupported by Step Functions",
      "Error": "ReThrowFromFinally",
      "Type": "Fail",
    },
    "throw new Error(\\"little\\")": Object {
      "Next": "await task(\\"2\\")",
      "Result": Object {
        "message": "little",
      },
      "ResultPath": "$.0_tmp",
      "Type": "Pass",
    },
  },
}
`;

exports[`try { throw } catch { (maybe) throw } finally { task } 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "throw new Error(\\"go\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await task()": Object {
      "Next": "exit finally",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "exit finally": Object {
      "Choices": Array [
        Object {
          "IsPresent": true,
          "Next": "throw finally",
          "Variable": "$.0_tmp",
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
    "if(input.id == \\"sam\\")": Object {
      "Choices": Array [
        Object {
          "Next": "throw new Error(\\"little\\")",
          "StringEquals": "sam",
          "Variable": "$.id",
        },
      ],
      "Default": "await task()",
      "Type": "Choice",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "throw finally": Object {
      "Cause": "an error was re-thrown from a finally block which is unsupported by Step Functions",
      "Error": "ReThrowFromFinally",
      "Type": "Fail",
    },
    "throw new Error(\\"go\\")": Object {
      "Next": "if(input.id == \\"sam\\")",
      "Result": Object {
        "message": "go",
      },
      "ResultPath": null,
      "Type": "Pass",
    },
    "throw new Error(\\"little\\")": Object {
      "Next": "await task()",
      "Result": Object {
        "message": "little",
      },
      "ResultPath": "$.0_tmp",
      "Type": "Pass",
    },
  },
}
`;

exports[`try, task, empty catch 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "await computeScore({id: \\"id\\", name: \\"name\\"})",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await computeScore({id: \\"id\\", name: \\"name\\"})": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "return null",
          "ResultPath": null,
        },
      ],
      "Next": "return null",
      "Parameters": Object {
        "id": "id",
        "name": "name",
      },
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`try, throw Error('error'), empty catch 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "throw Error(\\"cause\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "throw Error(\\"cause\\")": Object {
      "Next": "return null",
      "Result": Object {
        "message": "cause",
      },
      "ResultPath": null,
      "Type": "Pass",
    },
  },
}
`;

exports[`try, throw, catch, throw, finally, return 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "throw new Error(\\"go\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return \\"rock-star\\"": Object {
      "End": true,
      "Result": "rock-star",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "throw new Error(\\"go\\")": Object {
      "Next": "throw new Error(\\"little\\")",
      "Result": Object {
        "message": "go",
      },
      "ResultPath": null,
      "Type": "Pass",
    },
    "throw new Error(\\"little\\")": Object {
      "Next": "return \\"rock-star\\"",
      "Result": Object {
        "message": "little",
      },
      "ResultPath": null,
      "Type": "Pass",
    },
  },
}
`;

exports[`try, throw, empty catch 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "throw new CustomError(\\"cause\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "throw new CustomError(\\"cause\\")": Object {
      "Next": "return null",
      "Result": Object {
        "property": "cause",
      },
      "ResultPath": null,
      "Type": "Pass",
    },
  },
}
`;

exports[`try, throw, finally 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "throw new Error(\\"cause\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return \\"hello\\"": Object {
      "End": true,
      "Result": "hello",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "throw new Error(\\"cause\\")": Object {
      "Next": "return \\"hello\\"",
      "Result": Object {
        "message": "cause",
      },
      "ResultPath": null,
      "Type": "Pass",
    },
  },
}
`;

exports[`try-catch with guaranteed throw new Error 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "throw new Error(\\"cause\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "if(err.message == \\"cause\\")": Object {
      "Choices": Array [
        Object {
          "Next": "return \\"hello\\"",
          "StringEquals": "cause",
          "Variable": "$.err.message",
        },
      ],
      "Default": "return \\"world\\"",
      "Type": "Choice",
    },
    "return \\"hello\\"": Object {
      "End": true,
      "Result": "hello",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"world\\"": Object {
      "End": true,
      "Result": "world",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "throw new Error(\\"cause\\")": Object {
      "Next": "if(err.message == \\"cause\\")",
      "Result": Object {
        "message": "cause",
      },
      "ResultPath": "$.err",
      "Type": "Pass",
    },
  },
}
`;

exports[`try-catch with inner return and a catch variable 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_catch(err)": Object {
      "InputPath": "$.err.0_ParsedError",
      "Next": "return err.message",
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "__fnl_constants": Object {
      "Next": "await computeScore({id: \\"id\\", name: \\"name\\"})",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await computeScore({id: \\"id\\", name: \\"name\\"})": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "catch(err)",
          "ResultPath": "$.err",
        },
      ],
      "Next": "return \\"hello\\"",
      "Parameters": Object {
        "id": "id",
        "name": "name",
      },
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "catch(err)": Object {
      "Next": "0_catch(err)",
      "Parameters": Object {
        "0_ParsedError.$": "States.StringToJson($.err.Cause)",
      },
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "return \\"hello\\"": Object {
      "End": true,
      "Result": "hello",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return err.message": Object {
      "End": true,
      "OutputPath": "$.err.message",
      "Type": "Pass",
    },
  },
}
`;

exports[`try-catch with inner return and no catch variable 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "await computeScore({id: \\"id\\", name: \\"name\\"})",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await computeScore({id: \\"id\\", name: \\"name\\"})": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "return \\"world\\"",
          "ResultPath": null,
        },
      ],
      "Next": "return \\"hello\\"",
      "Parameters": Object {
        "id": "id",
        "name": "name",
      },
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "return \\"hello\\"": Object {
      "End": true,
      "Result": "hello",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"world\\"": Object {
      "End": true,
      "Result": "world",
      "ResultPath": "$",
      "Type": "Pass",
    },
  },
}
`;

exports[`try-catch with optional return of task 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_catch(err)": Object {
      "InputPath": "$.err.0_ParsedError",
      "Next": "if(err.message == \\"cause\\")",
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "__fnl_constants": Object {
      "Next": "if(input.id == \\"hello\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await computeScore({id: input.id, name: \\"sam\\"})": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "catch(err)",
          "ResultPath": "$.err",
        },
      ],
      "Next": "return \\"hello world\\"",
      "Parameters": Object {
        "id.$": "$.id",
        "name": "sam",
      },
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "catch(err)": Object {
      "Next": "0_catch(err)",
      "Parameters": Object {
        "0_ParsedError.$": "States.StringToJson($.err.Cause)",
      },
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "if(err.message == \\"cause\\")": Object {
      "Choices": Array [
        Object {
          "Next": "return \\"hello\\"",
          "StringEquals": "cause",
          "Variable": "$.err.message",
        },
      ],
      "Default": "return \\"world\\"",
      "Type": "Choice",
    },
    "if(input.id == \\"hello\\")": Object {
      "Choices": Array [
        Object {
          "Next": "await computeScore({id: input.id, name: \\"sam\\"})",
          "StringEquals": "hello",
          "Variable": "$.id",
        },
      ],
      "Default": "return \\"hello world\\"",
      "Type": "Choice",
    },
    "return \\"hello world\\"": Object {
      "End": true,
      "Result": "hello world",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"hello\\"": Object {
      "End": true,
      "Result": "hello",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"world\\"": Object {
      "End": true,
      "Result": "world",
      "ResultPath": "$",
      "Type": "Pass",
    },
  },
}
`;

exports[`try-catch with optional return of task 2`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_catch(err)": Object {
      "InputPath": "$.err.0_ParsedError",
      "Next": "if(err.message == \\"cause\\")",
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "__fnl_constants": Object {
      "Next": "if(input.id == \\"hello\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "catch(err)": Object {
      "Next": "0_catch(err)",
      "Parameters": Object {
        "0_ParsedError.$": "States.StringToJson($.err.Cause)",
      },
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "if(err.message == \\"cause\\")": Object {
      "Choices": Array [
        Object {
          "Next": "return \\"hello\\"",
          "StringEquals": "cause",
          "Variable": "$.err.message",
        },
      ],
      "Default": "return \\"world\\"",
      "Type": "Choice",
    },
    "if(input.id == \\"hello\\")": Object {
      "Choices": Array [
        Object {
          "Next": "return await computeScore({id: input.id, name: \\"sam\\"})",
          "StringEquals": "hello",
          "Variable": "$.id",
        },
      ],
      "Default": "return \\"hello world\\"",
      "Type": "Choice",
    },
    "return \\"hello world\\"": Object {
      "End": true,
      "Result": "hello world",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"hello\\"": Object {
      "End": true,
      "Result": "hello",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"world\\"": Object {
      "End": true,
      "Result": "world",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return await computeScore({id: input.id, name: \\"sam\\"})": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "catch(err)",
          "ResultPath": "$.err",
        },
      ],
      "End": true,
      "Parameters": Object {
        "id.$": "$.id",
        "name": "sam",
      },
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$",
      "Type": "Task",
    },
  },
}
`;

exports[`try-catch with optional task 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_catch(err)": Object {
      "InputPath": "$.err.0_ParsedError",
      "Next": "if(err.message == \\"cause\\")",
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "__fnl_constants": Object {
      "Next": "if(input.id == \\"hello\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await computeScore({id: input.id, name: \\"sam\\"})": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "catch(err)",
          "ResultPath": "$.err",
        },
      ],
      "Next": "return \\"hello world\\"",
      "Parameters": Object {
        "id.$": "$.id",
        "name": "sam",
      },
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "catch(err)": Object {
      "Next": "0_catch(err)",
      "Parameters": Object {
        "0_ParsedError.$": "States.StringToJson($.err.Cause)",
      },
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "if(err.message == \\"cause\\")": Object {
      "Choices": Array [
        Object {
          "Next": "return \\"hello\\"",
          "StringEquals": "cause",
          "Variable": "$.err.message",
        },
      ],
      "Default": "return \\"world\\"",
      "Type": "Choice",
    },
    "if(input.id == \\"hello\\")": Object {
      "Choices": Array [
        Object {
          "Next": "await computeScore({id: input.id, name: \\"sam\\"})",
          "StringEquals": "hello",
          "Variable": "$.id",
        },
      ],
      "Default": "return \\"hello world\\"",
      "Type": "Choice",
    },
    "return \\"hello world\\"": Object {
      "End": true,
      "Result": "hello world",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"hello\\"": Object {
      "End": true,
      "Result": "hello",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"world\\"": Object {
      "End": true,
      "Result": "world",
      "ResultPath": "$",
      "Type": "Pass",
    },
  },
}
`;

exports[`try-catch with optional throw of an Error 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "if(input.id == \\"hello\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "if(err.message == \\"cause\\")": Object {
      "Choices": Array [
        Object {
          "Next": "return \\"hello\\"",
          "StringEquals": "cause",
          "Variable": "$.err.message",
        },
      ],
      "Default": "return \\"world\\"",
      "Type": "Choice",
    },
    "if(input.id == \\"hello\\")": Object {
      "Choices": Array [
        Object {
          "Next": "throw new Error(\\"cause\\")",
          "StringEquals": "hello",
          "Variable": "$.id",
        },
      ],
      "Default": "return \\"hello world\\"",
      "Type": "Choice",
    },
    "return \\"hello world\\"": Object {
      "End": true,
      "Result": "hello world",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"hello\\"": Object {
      "End": true,
      "Result": "hello",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return \\"world\\"": Object {
      "End": true,
      "Result": "world",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "throw new Error(\\"cause\\")": Object {
      "Next": "if(err.message == \\"cause\\")",
      "Result": Object {
        "message": "cause",
      },
      "ResultPath": "$.err",
      "Type": "Pass",
    },
  },
}
`;

exports[`try-catch, err variable, contains for-of, throw Error 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_catch(err)": Object {
      "InputPath": "$.err.0_ParsedError",
      "Next": "return err.message",
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "__fnl_constants": Object {
      "Next": "for(item of input.items)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "catch(err)": Object {
      "Next": "0_catch(err)",
      "Parameters": Object {
        "0_ParsedError.$": "States.StringToJson($.err.Cause)",
      },
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "for(item of input.items)": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "catch(err)",
          "ResultPath": "$.err",
        },
      ],
      "ItemsPath": "$.items",
      "Iterator": Object {
        "StartAt": "throw Error(\\"err\\")",
        "States": Object {
          "throw Error(\\"err\\")": Object {
            "Cause": "{\\"message\\":\\"err\\"}",
            "Error": "Error",
            "Type": "Fail",
          },
        },
      },
      "MaxConcurrency": 1,
      "Next": "return null",
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": null,
      "Type": "Map",
    },
    "return err.message": Object {
      "End": true,
      "OutputPath": "$.err.message",
      "Type": "Pass",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`try-catch, err variable, contains for-of, throw new Error 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "0_catch(err)": Object {
      "InputPath": "$.err.0_ParsedError",
      "Next": "return err.message",
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "__fnl_constants": Object {
      "Next": "for(item of input.items)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "catch(err)": Object {
      "Next": "0_catch(err)",
      "Parameters": Object {
        "0_ParsedError.$": "States.StringToJson($.err.Cause)",
      },
      "ResultPath": "$.err",
      "Type": "Pass",
    },
    "for(item of input.items)": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "catch(err)",
          "ResultPath": "$.err",
        },
      ],
      "ItemsPath": "$.items",
      "Iterator": Object {
        "StartAt": "throw new Error(\\"err\\")",
        "States": Object {
          "throw new Error(\\"err\\")": Object {
            "Cause": "{\\"message\\":\\"err\\"}",
            "Error": "Error",
            "Type": "Fail",
          },
        },
      },
      "MaxConcurrency": 1,
      "Next": "return null",
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": null,
      "Type": "Map",
    },
    "return err.message": Object {
      "End": true,
      "OutputPath": "$.err.message",
      "Type": "Pass",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`try-catch, no variable, contains for-of, throw 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "for(item of input.items)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "for(item of input.items)": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "return \\"hello\\"",
          "ResultPath": null,
        },
      ],
      "ItemsPath": "$.items",
      "Iterator": Object {
        "StartAt": "throw new Error(\\"err\\")",
        "States": Object {
          "throw new Error(\\"err\\")": Object {
            "Cause": "{\\"message\\":\\"err\\"}",
            "Error": "Error",
            "Type": "Fail",
          },
        },
      },
      "MaxConcurrency": 1,
      "Next": "return null",
      "Parameters": Object {
        "item.$": "$$.Map.Item.Value",
      },
      "ResultPath": null,
      "Type": "Map",
    },
    "return \\"hello\\"": Object {
      "End": true,
      "Result": "hello",
      "ResultPath": "$",
      "Type": "Pass",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`try-catch-finally 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "await computeScore({id: \\"id\\", name: \\"name\\"})",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await computeScore({id: \\"id\\", name: \\"name\\"})": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "return \\"hello\\"",
          "ResultPath": null,
        },
      ],
      "Next": "return \\"hello\\"",
      "Parameters": Object {
        "id": "id",
        "name": "name",
      },
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "return \\"hello\\"": Object {
      "End": true,
      "Result": "hello",
      "ResultPath": "$",
      "Type": "Pass",
    },
  },
}
`;

exports[`waitFor literal number of seconds 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "$SFN.waitFor(1)": Object {
      "Next": "return null",
      "Seconds": 1,
      "Type": "Wait",
    },
    "__fnl_constants": Object {
      "Next": "$SFN.waitFor(1)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`waitFor literal timestamp 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "$SFN.waitUntil(\\"2022-08-01T00:00:00Z\\")": Object {
      "Next": "return null",
      "Timestamp": "2022-08-01T00:00:00Z",
      "Type": "Wait",
    },
    "__fnl_constants": Object {
      "Next": "$SFN.waitUntil(\\"2022-08-01T00:00:00Z\\")",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`waitFor reference number of seconds 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "$SFN.waitFor(input.seconds)": Object {
      "Next": "return null",
      "SecondsPath": "$.seconds",
      "Type": "Wait",
    },
    "__fnl_constants": Object {
      "Next": "$SFN.waitFor(input.seconds)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`waitUntil reference timestamp 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "$SFN.waitUntil(input.until)": Object {
      "Next": "return null",
      "TimestampPath": "$.until",
      "Type": "Wait",
    },
    "__fnl_constants": Object {
      "Next": "$SFN.waitUntil(input.until)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
  },
}
`;

exports[`while (cond) { cond = task() } 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "while (cond == undefined)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "cond = await task()": Object {
      "Next": "while (cond == undefined)",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$.cond",
      "Type": "Task",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "while (cond == undefined)": Object {
      "Choices": Array [
        Object {
          "Next": "cond = await task()",
          "Or": Array [
            Object {
              "IsPresent": false,
              "Variable": "$.cond",
            },
            Object {
              "IsNull": true,
              "Variable": "$.cond",
            },
          ],
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
  },
}
`;

exports[`while (cond); cond = task() 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "__fnl_constants": Object {
      "Next": "while (cond == undefined)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "cond = await task()": Object {
      "Next": "while (cond == undefined)",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": "$.cond",
      "Type": "Task",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "while (cond == undefined)": Object {
      "Choices": Array [
        Object {
          "Next": "cond = await task()",
          "Or": Array [
            Object {
              "IsPresent": false,
              "Variable": "$.cond",
            },
            Object {
              "IsNull": true,
              "Variable": "$.cond",
            },
          ],
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
  },
}
`;

exports[`while(true) { try { } catch { wait } 1`] = `
Object {
  "StartAt": "__fnl_constants",
  "States": Object {
    "$SFN.waitFor(1)": Object {
      "Next": "while (true)",
      "Seconds": 1,
      "Type": "Wait",
    },
    "__fnl_constants": Object {
      "Next": "while (true)",
      "Parameters": Object {
        "null": null,
      },
      "ResultPath": "$.__fnl_constants",
      "Type": "Pass",
    },
    "await task()": Object {
      "Catch": Array [
        Object {
          "ErrorEquals": Array [
            "States.ALL",
          ],
          "Next": "$SFN.waitFor(1)",
          "ResultPath": null,
        },
      ],
      "Next": "while (true)",
      "Resource": "__REPLACED_TOKEN",
      "ResultPath": null,
      "Type": "Task",
    },
    "return null": Object {
      "End": true,
      "OutputPath": "$.null",
      "Parameters": Object {
        "null": null,
      },
      "Type": "Pass",
    },
    "while (true)": Object {
      "Choices": Array [
        Object {
          "IsPresent": false,
          "Next": "await task()",
          "Variable": "$.0_true",
        },
      ],
      "Default": "return null",
      "Type": "Choice",
    },
  },
}
`;
